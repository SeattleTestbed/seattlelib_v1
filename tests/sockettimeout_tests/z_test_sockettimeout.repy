"""
<Description>
  
<Date>
  Sun Mar  1 10:27:35 PST 2009
"""
# hello world
include sockettimeout.repy

MESSAGE = "hello world!"
HUGE = 100

def mycallback(ip, port, sockobj, commhandle, listenhandle):
  hw_message = sockobj.recv(HUGE)
  assert hw_message == MESSAGE
  timeout_stopcomm(sockobj)
  
def server():
  sockobj = timeout_waitforconn(getmyip(), 12345, mycallback)

def client():
  sockobj = timeout_openconn(getmyip(), 12345)
  assert sockobj.send(MESSAGE) == len(MESSAGE)

def main():
  server()
  client()
  exitall()

if callfunc == 'initialize':
  main()
